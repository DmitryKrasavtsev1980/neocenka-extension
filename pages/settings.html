<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neocenka - Настройки</title>
    <link rel="stylesheet" href="../libs/tailwind/tailwind.min.css">
    <link rel="stylesheet" href="../assets/styles/main.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Навигация -->
    <div id="navigation-container"></div>

    <!-- Основной контент -->
    <div id="page-content" class="bg-white shadow-sm ring-1 ring-gray-900/5 rounded-lg p-6">
        <!-- Контент будет перенесен сюда -->
    </div>

    <!-- Скрытый контент настроек -->
    <div class="hidden" id="settings-content">
        <!-- Настройки парсинга -->
        <div class="bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Настройки парсинга</h3>
                <p class="mt-1 text-sm text-gray-500">Параметры сбора данных с сайтов</p>
            </div>
            <form id="settingsForm" class="p-6">
                <div class="grid grid-cols-1 gap-6 md:grid-cols-3">
                    <div>
                        <label for="avitoDelay" class="block text-sm font-medium text-gray-700">Задержка для Avito
                            (секунды)</label>
                        <input type="number" id="avitoDelay" name="parsing_delay_avito" min="10" max="300"
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        <p class="mt-1 text-xs text-gray-500">Рекомендуется 30-60 секунд для избежания блокировки
                        </p>
                    </div>

                    <div>
                        <label for="cianDelay" class="block text-sm font-medium text-gray-700">Задержка для Cian
                            (секунды)</label>
                        <input type="number" id="cianDelay" name="parsing_delay_cian" min="10" max="300"
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        <p class="mt-1 text-xs text-gray-500">Рекомендуется 30-60 секунд для избежания блокировки
                        </p>
                    </div>

                    <div>
                        <label for="updateDays" class="block text-sm font-medium text-gray-700">Количество дней для
                            обновления объявлений</label>
                        <input type="number" id="updateDays" name="update_days" min="1" max="365" value="7"
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        <p class="mt-1 text-xs text-gray-500">Обновлять объявления не чаще чем указанное количество
                            дней</p>
                    </div>
                </div>

                <div class="mt-6 space-y-4">
                    <div class="flex items-start">
                        <div class="flex items-center h-5">
                            <input id="autoProcessDuplicates" name="auto_process_duplicates" type="checkbox"
                                class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="autoProcessDuplicates" class="font-medium text-gray-700">Автоматическая
                                обработка дублей</label>
                            <p class="text-gray-500">Автоматически объединять похожие объявления в объекты
                                недвижимости</p>
                        </div>
                    </div>

                    <div class="flex items-start">
                        <div class="flex items-center h-5">
                            <input id="autoArchive" name="auto_archive_listings" type="checkbox"
                                class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="autoArchive" class="font-medium text-gray-700">Автоархивирование</label>
                            <p class="text-gray-500">Автоматически переводить снятые с публикации объявления в архив
                            </p>
                        </div>
                    </div>
                </div>

                <div class="mt-6">
                    <button type="button" id="saveSettingsBtn"
                        class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                        <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                        Сохранить настройки
                    </button>
                </div>
            </form>
        </div>

        <!-- Настройки AI-ассистента -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Настройки AI-ассистента</h3>
                <p class="mt-1 text-sm text-gray-500">Конфигурация провайдеров искусственного интеллекта</p>
            </div>
            <form id="aiSettingsForm" class="p-6">
                <!-- Общие настройки AI -->
                <div class="mb-8">
                    <h4 class="text-base font-medium text-gray-900 mb-4">Общие параметры</h4>
                    
                    <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                        <div>
                            <label for="aiEnabled" class="flex items-center">
                                <input type="checkbox" id="aiEnabled" name="ai_enabled" 
                                       class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                <span class="ml-2 text-sm font-medium text-gray-700">Включить AI-ассистента</span>
                            </label>
                            <p class="mt-1 text-xs text-gray-500">Показывать кнопку чата и активировать AI-функции</p>
                        </div>

                        <div>
                            <label for="primaryProvider" class="block text-sm font-medium text-gray-700">Основной провайдер</label>
                            <select id="primaryProvider" name="primary_provider"
                                    class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                <option value="yandex">YandexGPT</option>
                                <option value="claude">Claude (Anthropic)</option>
                            </select>
                            <p class="mt-1 text-xs text-gray-500">Выберите предпочитаемый AI-провайдер</p>
                        </div>
                    </div>
                </div>

                <!-- Настройки YandexGPT -->
                <div class="mb-8">
                    <h4 class="text-base font-medium text-gray-900 mb-4">YandexGPT</h4>
                    
                    <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                        <div>
                            <label for="yandexApiKey" class="block text-sm font-medium text-gray-700">API-ключ</label>
                            <input type="password" id="yandexApiKey" name="yandex_api_key"
                                   placeholder="AQVN..."
                                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <p class="mt-1 text-xs text-gray-500">API-ключ из Yandex Cloud Console</p>
                        </div>

                        <div>
                            <label for="yandexFolderId" class="block text-sm font-medium text-gray-700">Folder ID</label>
                            <input type="text" id="yandexFolderId" name="yandex_folder_id"
                                   placeholder="b1g2ab3c4def5gh6"
                                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <p class="mt-1 text-xs text-gray-500">ID каталога из Yandex Cloud</p>
                        </div>

                        <div>
                            <label for="yandexModel" class="block text-sm font-medium text-gray-700">Модель</label>
                            <select id="yandexModel" name="yandex_model"
                                    class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                <option value="yandexgpt-lite/latest">YandexGPT Lite (экономичная)</option>
                                <option value="yandexgpt/latest">YandexGPT (стандартная)</option>
                            </select>
                            <p class="mt-1 text-xs text-gray-500">Lite модель дешевле, стандартная - качественнее</p>
                        </div>

                        <div class="flex items-end">
                            <button type="button" id="testYandexBtn"
                                    class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                                <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                          d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Проверить подключение
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Настройки Claude -->
                <div class="mb-8">
                    <h4 class="text-base font-medium text-gray-900 mb-4">Claude (Anthropic)</h4>
                    
                    <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                        <div>
                            <label for="claudeApiKey" class="block text-sm font-medium text-gray-700">API-ключ</label>
                            <input type="password" id="claudeApiKey" name="claude_api_key"
                                   placeholder="sk-ant-api..."
                                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <p class="mt-1 text-xs text-gray-500">API-ключ от Anthropic</p>
                        </div>

                        <div>
                            <label for="claudeModel" class="block text-sm font-medium text-gray-700">Модель</label>
                            <select id="claudeModel" name="claude_model"
                                    class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                <option value="claude-3-haiku-20240307">Claude 3 Haiku (быстрая)</option>
                                <option value="claude-3-sonnet-20240229">Claude 3 Sonnet (стандартная)</option>
                                <option value="claude-3-opus-20240229">Claude 3 Opus (продвинутая)</option>
                            </select>
                            <p class="mt-1 text-xs text-gray-500">Haiku дешевле, Opus качественнее</p>
                        </div>

                        <div class="flex items-end">
                            <button type="button" id="testClaudeBtn"
                                    class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                                <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                          d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Проверить подключение
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Статус подключения -->
                <div class="mb-6">
                    <h4 class="text-base font-medium text-gray-900 mb-4">Статус подключения</h4>
                    <div id="aiStatusContainer" class="space-y-2">
                        <div id="yandexStatus" class="flex items-center">
                            <div class="w-3 h-3 rounded-full bg-gray-300 mr-3"></div>
                            <span class="text-sm text-gray-500">YandexGPT: не настроен</span>
                        </div>
                        <div id="claudeStatus" class="flex items-center">
                            <div class="w-3 h-3 rounded-full bg-gray-300 mr-3"></div>
                            <span class="text-sm text-gray-500">Claude: не настроен</span>
                        </div>
                    </div>
                </div>

                <!-- Кнопки сохранения -->
                <div class="flex space-x-3">
                    <button type="button" id="saveAISettingsBtn"
                            class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                        <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        Сохранить настройки AI
                    </button>
                    
                    <button type="button" id="testAllAIBtn"
                            class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                        <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                  d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        Проверить все подключения
                    </button>
                </div>
            </form>
        </div>

        <!-- Полный экспорт/импорт базы данных -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Полный экспорт/импорт базы данных</h3>
                <p class="mt-1 text-sm text-gray-500">Экспорт и импорт всех данных: областей с полигонами, адресов, фильтров</p>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                    <div class="space-y-4">
                        <h4 class="text-sm font-medium text-gray-900">Экспорт данных</h4>
                        <p class="text-xs text-gray-600">Выберите какие блоки данных экспортировать</p>
                        
                        <!-- Быстрые настройки -->
                        <div class="flex space-x-2 text-xs">
                            <button type="button" id="selectAllExport" class="text-blue-600 hover:text-blue-800">Выбрать всё</button>
                            <span class="text-gray-400">•</span>
                            <button type="button" id="selectNoneExport" class="text-blue-600 hover:text-blue-800">Снять всё</button>
                            <span class="text-gray-400">•</span>
                            <button type="button" id="selectAddressesOnly" class="text-blue-600 hover:text-blue-800">Только адреса</button>
                        </div>

                        <!-- Чекбоксы для выбора блоков -->
                        <div class="space-y-2 bg-gray-50 p-3 rounded-md">
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="exportMapAreas" type="checkbox" checked
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="exportMapAreas" class="font-medium text-gray-700">📍 Области</label>
                                    <p class="text-gray-500 text-xs">Области с полигонами и фильтрами Avito/Cian</p>
                                </div>
                            </div>

                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="exportAddresses" type="checkbox" checked
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="exportAddresses" class="font-medium text-gray-700">🏠 Адреса</label>
                                    <p class="text-gray-500 text-xs">Все адреса с координатами и характеристиками зданий</p>
                                </div>
                            </div>

                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="exportSegments" type="checkbox" checked
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="exportSegments" class="font-medium text-gray-700">📋 Сегменты</label>
                                    <p class="text-gray-500 text-xs">Сегменты и подсегменты областей</p>
                                </div>
                            </div>

                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="exportListings" type="checkbox"
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="exportListings" class="font-medium text-gray-700">📊 Объявления</label>
                                    <p class="text-gray-500 text-xs">Объявления с сайтов и объекты недвижимости</p>
                                </div>
                            </div>

                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="exportReports" type="checkbox"
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="exportReports" class="font-medium text-gray-700">📈 Отчёты</label>
                                    <p class="text-gray-500 text-xs">Созданные отчёты и аналитика</p>
                                </div>
                            </div>

                            <div class="flex items-start">
                                <div class="flex items-centers h-5">
                                    <input id="exportReferences" type="checkbox" checked
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="exportReferences" class="font-medium text-gray-700">📚 Справочники</label>
                                    <p class="text-gray-500 text-xs">Материалы стен, серии домов, классы домов и т.д.</p>
                                </div>
                            </div>

                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="exportSettings" type="checkbox" checked
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="exportSettings" class="font-medium text-gray-700">⚙️ Настройки</label>
                                    <p class="text-gray-500 text-xs">Настройки приложения и API ключи</p>
                                </div>
                            </div>
                        </div>

                        <button type="button" id="fullExportBtn"
                            class="w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                            <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                            Экспорт выбранных данных
                        </button>
                        <div id="fullExportStatus" class="text-sm text-gray-600 hidden">
                            <!-- Статус экспорта -->
                        </div>
                    </div>

                    <div class="space-y-4">
                        <h4 class="text-sm font-medium text-gray-900">Импорт данных</h4>
                        <p class="text-xs text-gray-600">⚠️ ВНИМАНИЕ: Полностью заменит все данные! Импортирует области, адреса, настройки из файла экспорта</p>
                        <button type="button" id="fullImportBtn"
                            class="w-full inline-flex justify-center items-center px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-red-50 hover:bg-red-100">
                            <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                            </svg>
                            Полный импорт базы данных
                        </button>
                        <input type="file" id="fullImportFileInput" accept=".json" class="hidden">
                        <div id="fullImportStatus" class="text-sm text-gray-600 hidden">
                            <!-- Статус импорта -->
                        </div>
                    </div>
                </div>

                <!-- Результаты операций -->
                <div id="fullDataOperationResults" class="mt-6 hidden">
                    <!-- Результаты будут добавлены через JS -->
                </div>
            </div>
        </div>

        <!-- Управление данными -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Управление данными</h3>
                <p class="mt-1 text-sm text-gray-500">Обработка дублей и очистка данных</p>
            </div>
            <div class="p-6">
                <div class="space-y-3">
                    <button type="button" id="processDuplicatesBtn"
                        class="w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                        <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2v0M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2">
                            </path>
                        </svg>
                        Обработать дубли
                    </button>

                    <button type="button" id="clearDataBtn"
                        class="w-full inline-flex justify-center items-center px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50">
                        <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                            </path>
                        </svg>
                        Очистить все данные
                    </button>
                </div>
            </div>
        </div>

        <!-- Статистика базы данных -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Статистика базы данных</h3>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-2 gap-6 md:grid-cols-4">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600" id="statsSegments">0</div>
                        <div class="text-sm text-gray-500">Сегментов</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="statsListings">0</div>
                        <div class="text-sm text-gray-500">Объявлений</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-purple-600" id="statsObjects">0</div>
                        <div class="text-sm text-gray-500">Объектов</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-orange-600" id="statsReports">0</div>
                        <div class="text-sm text-gray-500">Отчетов</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Синхронизация -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Синхронизация</h3>
                <p class="mt-1 text-sm text-gray-500">Синхронизация данных между устройствами</p>
            </div>
            <div class="p-6">
                <div class="space-y-4">
                    <div class="flex items-start">
                        <div class="flex items-center h-5">
                            <input id="syncEnabled" name="sync_enabled" type="checkbox"
                                class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="syncEnabled" class="font-medium text-gray-700">Включить
                                синхронизацию</label>
                            <p class="text-gray-500">Синхронизировать данные между устройствами через Chrome Sync
                            </p>
                        </div>
                    </div>

                    <div id="syncKeyContainer" class="hidden">
                        <label for="syncKey" class="block text-sm font-medium text-gray-700">Ключ
                            синхронизации</label>
                        <div class="mt-1 flex rounded-md shadow-sm">
                            <input type="text" id="syncKey" name="sync_key"
                                class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-l-md border border-gray-300 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                                placeholder="Введите или сгенерируйте ключ">
                            <button type="button" id="generateSyncKey"
                                class="inline-flex items-center px-3 py-2 border border-l-0 border-gray-300 rounded-r-md bg-gray-50 text-gray-500 text-sm hover:bg-gray-100">
                                Сгенерировать
                            </button>
                        </div>
                        <p class="mt-1 text-xs text-gray-500">Используйте один и тот же ключ на всех устройствах для
                            синхронизации</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Статус подписки -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Статус подписки</h3>
                <p class="mt-1 text-sm text-gray-500">Управление подпиской и API ключом</p>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                    <div>
                        <label for="apiKey" class="block text-sm font-medium text-gray-700">API ключ</label>
                        <div class="mt-1 flex rounded-md shadow-sm">
                            <input type="password" id="apiKey" name="api_key"
                                class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-l-md border border-gray-300 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                                placeholder="Введите API ключ с сайта neocenka.ru">
                            <button type="button" id="checkSubscriptionBtn"
                                class="inline-flex items-center px-3 py-2 border border-l-0 border-gray-300 rounded-r-md bg-gray-50 text-gray-500 text-sm hover:bg-gray-100">
                                Проверить
                            </button>
                        </div>
                        <p class="mt-1 text-xs text-gray-500">Получите ключ в личном кабинете на <a
                                href="https://neocenka.ru" target="_blank"
                                class="text-blue-600 hover:text-blue-800">neocenka.ru</a></p>
                    </div>

                    <div id="subscriptionStatus" class="hidden">
                        <h4 class="text-sm font-medium text-gray-900 mb-3">Статус подписки</h4>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Статус:</span>
                                <span id="subscriptionStatusText"
                                    class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                    Активна
                                </span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">План:</span>
                                <span id="subscriptionPlan" class="text-sm font-medium text-gray-900">Premium</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Осталось дней:</span>
                                <span id="subscriptionDays" class="text-sm font-medium text-gray-900">15</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Запросов сегодня:</span>
                                <span id="apiRequestsToday" class="text-sm text-gray-600">45 / 1000</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="subscriptionFeatures" class="mt-6 hidden">
                    <h4 class="text-sm font-medium text-gray-900 mb-3">Доступные функции</h4>
                    <div class="grid grid-cols-2 gap-3 md:grid-cols-3">
                        <div class="flex items-center">
                            <svg class="h-4 w-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            <span class="text-sm text-gray-700">Парсинг данных</span>
                        </div>
                        <div class="flex items-center">
                            <svg class="h-4 w-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            <span class="text-sm text-gray-700">Расширенная аналитика</span>
                        </div>
                        <div class="flex items-center">
                            <svg class="h-4 w-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            <span class="text-sm text-gray-700">Экспорт данных</span>
                        </div>
                        <div class="flex items-center">
                            <svg class="h-4 w-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            <span class="text-sm text-gray-700">Уведомления</span>
                        </div>
                        <div class="flex items-center">
                            <svg class="h-4 w-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            <span class="text-sm text-gray-700">Отслеживание цен</span>
                        </div>
                        <div class="flex items-center">
                            <svg class="h-4 w-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            <span class="text-sm text-gray-700">Безлимитные сегменты</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Интеграция с Inpars.ru -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Интеграция с Inpars.ru</h3>
                <p class="mt-1 text-sm text-gray-500">Настройки подключения к сервису данных недвижимости</p>
            </div>
            <div class="p-6">
                <div class="space-y-6">
                    <!-- Токен API -->
                    <div>
                        <label for="inparsToken" class="block text-sm font-medium text-gray-700">Токен API Inpars</label>
                        <div class="mt-1 flex rounded-md shadow-sm">
                            <input type="password" id="inparsToken" name="inpars_token"
                                class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-l-md border border-gray-300 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                                placeholder="Введите токен API с сайта inpars.ru">
                            <button type="button" id="saveInparsToken"
                                class="inline-flex items-center px-3 py-2 border border-l-0 border-gray-300 rounded-r-md bg-gray-50 text-gray-500 text-sm hover:bg-gray-100">
                                Сохранить
                            </button>
                        </div>
                        <p class="mt-1 text-xs text-gray-500">Получите токен в личном кабинете на <a
                                href="https://inpars.ru" target="_blank"
                                class="text-blue-600 hover:text-blue-800">inpars.ru</a></p>
                    </div>

                    <!-- Статус подписки -->
                    <div id="inparsSubscriptionStatus" class="hidden">
                        <h4 class="text-sm font-medium text-gray-900 mb-3">Статус подписки Inpars</h4>
                        <div class="flex items-center space-x-3">
                            <div id="inparsStatusIndicator" class="flex items-center">
                                <div class="h-3 w-3 rounded-full bg-gray-400"></div>
                                <span id="inparsStatusText" class="ml-2 text-sm text-gray-600">Проверка...</span>
                            </div>
                            <button type="button" id="checkInparsSubscription"
                                class="text-sm text-blue-600 hover:text-blue-800">
                                Обновить статус
                            </button>
                        </div>
                        <div id="inparsSubscriptionDetails" class="mt-3 text-sm text-gray-600 hidden">
                            <!-- Детали подписки будут добавлены через JS -->
                        </div>
                    </div>

                    <!-- Импорт справочников -->
                    <div>
                        <h4 class="text-sm font-medium text-gray-900 mb-3">Справочники</h4>
                        <div class="space-y-3">
                            <button type="button" id="importInparsCategories"
                                class="w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                                <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10">
                                    </path>
                                </svg>
                                Импорт справочников Inpars
                            </button>
                            <div id="categoriesImportStatus" class="text-sm text-gray-600 hidden">
                                <!-- Статус импорта будет добавлен через JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Источники данных -->
                    <div>
                        <h4 class="text-sm font-medium text-gray-900 mb-3">Источники данных для импорта</h4>
                        <div class="space-y-3">
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="sourceAvito" name="inpars_source_avito" type="checkbox" checked
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="sourceAvito" class="font-medium text-gray-700">Avito</label>
                                    <p class="text-gray-500">Импортировать объявления с сайта Avito.ru</p>
                                </div>
                            </div>

                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="sourceCian" name="inpars_source_cian" type="checkbox" checked
                                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="sourceCian" class="font-medium text-gray-700">CIAN</label>
                                    <p class="text-gray-500">Импортировать объявления с сайта Cian.ru</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Статистика API -->
                    <div id="inparsApiStats" class="hidden">
                        <h4 class="text-sm font-medium text-gray-900 mb-3">Статистика API</h4>
                        <div class="bg-gray-50 rounded-md p-3">
                            <div class="grid grid-cols-2 gap-3 text-sm">
                                <div>
                                    <span class="text-gray-600">Запросов выполнено:</span>
                                    <span id="apiRequestCount" class="font-medium text-gray-900 ml-1">0</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">В очереди:</span>
                                    <span id="apiQueueLength" class="font-medium text-gray-900 ml-1">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ML-модель определения адресов -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">ML-модель определения адресов</h3>
                <p class="mt-1 text-sm text-gray-500">Обученная модель машинного обучения для повышения точности определения адресов</p>
            </div>
            <div class="p-6">
                <!-- Статистика модели -->
                <div class="mb-6">
                    <h4 class="text-sm font-medium text-gray-900 mb-3">Статистика модели</h4>
                    <div class="grid grid-cols-2 gap-4 md:grid-cols-4">
                        <div class="bg-gray-50 rounded-lg p-3">
                            <div class="text-xs text-gray-500">Версия</div>
                            <div id="mlModelVersion" class="text-sm font-medium text-gray-900">-</div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-3">
                            <div class="text-xs text-gray-500">Примеров обучения</div>
                            <div id="mlTrainingExamples" class="text-sm font-medium text-gray-900">-</div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-3">
                            <div class="text-xs text-gray-500">Точность</div>
                            <div id="mlModelAccuracy" class="text-sm font-medium text-gray-900">-</div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-3">
                            <div class="text-xs text-gray-500">Последнее обновление</div>
                            <div id="mlLastUpdate" class="text-sm font-medium text-gray-900">-</div>
                        </div>
                    </div>
                </div>

                <!-- Действия -->
                <div class="mb-6">
                    <h4 class="text-sm font-medium text-gray-900 mb-3">Действия</h4>
                    <div class="flex flex-wrap gap-3">
                        <button type="button" id="refreshMLStats"
                            class="inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                            <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                            Обновить статистику
                        </button>
                        <button type="button" id="exportMLModel"
                            class="inline-flex items-center px-3 py-2 border border-blue-300 rounded-md text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100">
                            <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            Экспортировать модель
                        </button>
                        <button type="button" id="copyMLModel"
                            class="inline-flex items-center px-3 py-2 border border-green-300 rounded-md text-sm font-medium text-green-700 bg-green-50 hover:bg-green-100">
                            <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                            </svg>
                            Копировать модель
                        </button>
                        <button type="button" id="analyzeTrainingData"
                            class="inline-flex items-center px-3 py-2 border border-purple-300 rounded-md text-sm font-medium text-purple-700 bg-purple-50 hover:bg-purple-100">
                            <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                            Анализ данных обучения
                        </button>
                    </div>
                </div>

                <!-- Экспорт модели -->
                <div>
                    <h4 class="text-sm font-medium text-gray-900 mb-3">Обученная модель (для коммита в GitHub)</h4>
                    <div class="space-y-3">
                        <textarea id="mlModelExport" readonly
                            class="w-full h-64 px-3 py-2 border border-gray-300 rounded-md text-xs font-mono bg-gray-50 resize-none"
                            placeholder="Обученная модель появится здесь после экспорта..."></textarea>
                        <div class="flex items-center justify-between">
                            <p class="text-xs text-gray-500">
                                Скопируйте этот JSON в файл <code class="bg-gray-200 px-1 rounded">utils/pretrained-model.json</code> и сделайте коммит
                            </p>
                            <div id="mlExportStatus" class="hidden">
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                    <svg class="-ml-0.5 mr-1.5 h-2 w-2" fill="currentColor" viewBox="0 0 8 8">
                                        <circle cx="4" cy="4" r="3"></circle>
                                    </svg>
                                    Скопировано
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Информация -->
                <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-md">
                    <div class="flex">
                        <svg class="flex-shrink-0 h-5 w-5 text-blue-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        <div class="ml-3">
                            <h5 class="text-sm font-medium text-blue-800">Как работает обучение модели</h5>
                            <div class="mt-2 text-sm text-blue-700">
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>Модель автоматически обучается при нажатии кнопок "Верный адрес"</li>
                                    <li>Каждые 50 подтверждений модель переобучается и улучшается</li>
                                    <li>Экспортируйте обученную модель и добавьте её в коммит для распространения</li>
                                    <li>Пользователи получат улучшенную модель при обновлении расширения</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Настройки отладки -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Настройки отладки</h3>
                <p class="mt-1 text-sm text-gray-500">Параметры для разработчиков и диагностики</p>
            </div>
            <div class="p-6">
                <div class="space-y-4">
                    <div class="flex items-start">
                        <div class="flex items-center h-5">
                            <input id="debugMode" name="debug_mode" type="checkbox" autocomplete="off"
                                class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="debugMode" class="font-medium text-gray-700">Включить отладочные
                                сообщения</label>
                            <p class="text-gray-500">Выводить подробные сообщения в консоль браузера для диагностики
                                работы приложения</p>
                        </div>
                    </div>

                    <div class="bg-yellow-50 border border-yellow-200 rounded-md p-3">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-yellow-700">
                                    <strong>Внимание:</strong> Отладочные сообщения видны только в консоли
                                    разработчика (F12).
                                    Включайте эту опцию только при возникновении проблем или по просьбе службы
                                    поддержки.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- О программе -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">О программе</h3>
            </div>
            <div class="p-6">
                <div class="flex items-center space-x-4">
                    <img src="../components/logo.svg" alt="Neocenka" class="h-12 w-12">
                    <div>
                        <h4 class="text-lg font-medium text-gray-900">Neocenka</h4>
                        <p class="text-sm text-gray-500">Версия 1.0.0</p>
                        <p class="text-sm text-gray-500">Анализ рынка недвижимости для Avito и Cian</p>
                    </div>
                </div>

                <div class="mt-6 grid grid-cols-1 gap-4 md:grid-cols-2">
                    <div>
                        <h5 class="text-sm font-medium text-gray-900 mb-2">Возможности</h5>
                        <ul class="text-sm text-gray-500 space-y-1">
                            <li>• Автоматический сбор объявлений</li>
                            <li>• Обработка дублирующихся объявлений</li>
                            <li>• Аналитика и отчеты</li>
                            <li>• Отслеживание изменения цен</li>
                            <li>• Экспорт данных</li>
                        </ul>
                    </div>

                    <div>
                        <h5 class="text-sm font-medium text-gray-900 mb-2">Поддержка</h5>
                        <div class="text-sm text-gray-500 space-y-1">
                            <p>Если у вас есть вопросы или предложения:</p>
                            <p>Email: support@neocenka.ru</p>
                            <p>GitHub: github.com/neocenka</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно подтверждения очистки данных -->
    <div id="clearDataModal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title"
        role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity modal-backdrop" aria-hidden="true">
            </div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div
                class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full modal-content">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div
                            class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
                            <svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z">
                                </path>
                            </svg>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                            <h3 class="text-lg leading-6 font-medium text-gray-900">Очистить все данные</h3>
                            <div class="mt-2">
                                <p class="text-sm text-gray-500">
                                    Вы уверены, что хотите удалить ВСЕ данные расширения? Это действие удалит:
                                </p>
                                <ul class="mt-2 text-sm text-gray-500 list-disc list-inside">
                                    <li>Все сегменты</li>
                                    <li>Все объявления</li>
                                    <li>Все объекты недвижимости</li>
                                    <li>Все отчеты</li>
                                    <li>Все настройки</li>
                                </ul>
                                <p class="mt-2 text-sm text-red-600 font-medium">Это действие нельзя отменить!</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="confirmClearData"
                        class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 sm:ml-3 sm:w-auto sm:text-sm">
                        Удалить все данные
                    </button>
                    <button type="button" id="cancelClearData"
                        class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                        Отмена
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Уведомления -->
    <div id="notifications" class="fixed top-4 right-4 z-50 space-y-4">
        <!-- Уведомления будут добавляться динамически -->
    </div>

    <!-- Футер -->
    <div id="footer-container"></div>

    <!-- Скрипты -->
    <script src="../components/navigation.js"></script>
    <script src="../components/breadcrumbs.js"></script>
    <script src="../components/footer.js"></script>
    <script src="../data/database.js"></script>
    <script src="../utils/subscription-service.js"></script>
    <script src="../utils/debug-logger.js"></script>
    
    <!-- Сервисная архитектура -->
    <script src="../services/base/BaseAPIService.js"></script>
    <script src="../services/base/ServiceManager.js"></script>
    <script src="../services/external/InparsService.js"></script>
    <script src="../services/ServiceConfig.js"></script>
    
    <!-- ML алгоритм для работы с моделью -->
    <script src="../libs/rbush/rbush.min.js"></script>
    <script src="../utils/geo-utils.js"></script>
    <script src="../utils/spatial-index-manager.js"></script>
    <script src="../utils/smart-address-matcher.js"></script>
    
    <!-- Core components (нужны для AI) -->
    <script src="core/EventBus.js"></script>
    <script src="core/DataState.js"></script>
    
    <!-- AI Services (нужны для настроек AI) -->
    <script src="../services/core/ValidationService.js"></script>
    <script src="../services/core/ConfigService.js"></script>
    <script src="../services/core/ErrorHandlingService.js"></script>
    <script src="../services/core/DIContainer.js"></script>
    
    <!-- AI Core Services (базовый класс первый) -->
    <script src="../services/ai/core/BaseLLMService.js"></script>
    
    <!-- AI Providers (провайдеры до фабрики!) -->
    <script src="../services/ai/providers/YandexProvider.js"></script>
    <script src="../services/ai/providers/ClaudeProvider.js"></script>
    
    <!-- AI Factory and Service (после провайдеров) -->
    <script src="../services/ai/core/LLMProviderFactory.js"></script>
    <script src="../services/ai/core/UniversalAIService.js"></script>
    
    <!-- AI Settings Initialization -->
    <script src="ai-settings-init.js"></script>
    
    <!-- AI Settings Handler -->
    <script src="../utils/ai-setup-helper.js"></script>
    <script src="ai-settings-handler.js"></script>

    <script src="settings_script.js"></script>

    <script src="settings_init.js"></script>
</body>

</html>